{"ast":null,"code":"import _slicedToArray from\"/Users/wentai/work space/wis/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext}from'react';import'./UploadPage.css';import ReactS3 from'react-s3';import axios from'axios';import{AppContext}from'../context/AppContext';var config={bucketName:'wis7202',// dirName: 'photos', /* optional */\nregion:'ap-southeast-2',accessKeyId:'AKIAJQ74GBMTNC3SOGBQ',secretAccessKey:'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'};function UploadPage(){var _useState=useState({video_url:'',buttonDisabled:true}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var _useContext=useContext(AppContext),currentUser=_useContext.currentUser;var upload=function upload(e){console.log('kkk');var upload_video=e.target.files[0];console.log(upload_video);ReactS3.uploadFile(upload_video,config).then(function(data){alert('loading succeed');setState({buttonDisabled:false,video_url:data.location});document.getElementById('showFileName').innerText=upload_video.name;}).catch(function(err){console.log(err);});};var handleSubmit=function handleSubmit(e){e.preventDefault();var description=e.target.description.value;var title=e.target.title.value;console.log(description);// send the video url to php\nvar url='http://localhost:80/react-backend/upload.php';var formData=new FormData();formData.append(\"title\",title);formData.append(\"video_upload\",state.video_url);formData.append(\"description\",description);formData.append(\"uploader\",currentUser);axios.post(url,formData).then(function(res){console.log(res);}).catch(function(err){return console.log(err);});alert('Congrats! You have published successfully.');};return React.createElement(\"form\",{className:\"uploadPage\",onSubmit:handleSubmit},React.createElement(\"div\",{className:\"uploadBox\"},React.createElement(\"span\",null,\"Please click Select File \",React.createElement(\"br\",null),\" OR \",React.createElement(\"br\",null),\"Drag your file here to upload\"),React.createElement(\"a\",{class:\"uploadBtn\"},\"Select File\",React.createElement(\"input\",{class:\"change\",accept:\"video/mp4\",type:\"file\",multiple:\"multiple\",onChange:upload})),React.createElement(\"p\",{id:\"showFileName\"},\"uploaded file\")),React.createElement(\"label\",null,\"Title\"),React.createElement(\"input\",{className:\"titleBox\",placeholder:\"Add a title for your video...\",name:\"title\"}),React.createElement(\"label\",null,\"Description\"),React.createElement(\"textarea\",{className:\"descriptionBox\",placeholder:\"Add descriptions for your video...\",name:\"description\"}),React.createElement(\"input\",{type:\"submit\",value:\"Publish\",className:\"descriptionUpload\",disabled:state.buttonDisabled}));}export default UploadPage;","map":{"version":3,"sources":["/Users/wentai/work space/wis/src/pages/UploadPage.js"],"names":["React","useState","useContext","ReactS3","axios","AppContext","config","bucketName","region","accessKeyId","secretAccessKey","UploadPage","video_url","buttonDisabled","state","setState","currentUser","upload","e","console","log","upload_video","target","files","uploadFile","then","data","alert","location","document","getElementById","innerText","name","catch","err","handleSubmit","preventDefault","description","value","title","url","formData","FormData","append","post","res"],"mappings":"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","sourcesContent":["import React, {useState, useContext} from 'react';\nimport './UploadPage.css'\nimport ReactS3 from 'react-s3';\nimport axios from 'axios';\nimport { AppContext } from '../context/AppContext';\n\nconst config = {\n    bucketName: 'wis7202',\n    // dirName: 'photos', /* optional */\n    region: 'ap-southeast-2',\n    accessKeyId: 'AKIAJQ74GBMTNC3SOGBQ',\n    secretAccessKey: '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',\n};\n\n\nfunction UploadPage () {\n\n    const [state, setState] = useState({\n        video_url:'',\n        buttonDisabled:true,\n    })\n\n\n    const {currentUser} = useContext(AppContext);\n\n    const upload = (e) => {\n        console.log('kkk');\n        let upload_video = e.target.files[0];\n        console.log(upload_video);\n        ReactS3.uploadFile(upload_video,config)\n            .then((data) => {\n                alert('loading succeed');\n                setState({buttonDisabled:false,video_url:data.location});\n                document.getElementById('showFileName').innerText = upload_video.name;\n            })\n            .catch((err) => {console.log(err)});\n            \n    }\n\n    const handleSubmit=(e) => {\n        e.preventDefault();\n        let description = e.target.description.value;\n        let title = e.target.title.value;\n        console.log(description);\n        // send the video url to php\n        const url = 'http://localhost:80/react-backend/upload.php';\n        const formData = new FormData;\n        formData.append(\"title\", title);\n        formData.append(\"video_upload\", state.video_url);\n        formData.append(\"description\", description);\n        formData.append(\"uploader\", currentUser);\n        axios.post(url,formData).then((res)=>{console.log(res)}).catch((err)=>console.log(err));\n        alert('Congrats! You have published successfully.');\n    };\n\n\n    return(\n        <form className = \"uploadPage\" onSubmit={handleSubmit}>\n            <div className = \"uploadBox\">\n                <span>Please click Select File <br/> OR <br/>Drag your file here to upload</span>\n                <a class=\"uploadBtn\">\n                    Select File\n                    <input class=\"change\" accept = \"video/mp4\" type=\"file\" multiple=\"multiple\" onChange = {upload}/>\n                </a>          \n                <p id='showFileName'>uploaded file</p>\n            </div>\n            \n            <label>Title</label>\n            <input className = \"titleBox\" placeholder = \"Add a title for your video...\" name = \"title\"/>\n\n            <label>Description</label>\n            <textarea className = \"descriptionBox\" placeholder = \"Add descriptions for your video...\" name = \"description\"/>\n\n            <input type=\"submit\" value=\"Publish\" className = \"descriptionUpload\" disabled = {state.buttonDisabled}/>\n        </form>\n    )\n    }\n\n\nexport default UploadPage;"]},"metadata":{},"sourceType":"module"}