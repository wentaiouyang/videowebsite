{"ast":null,"code":"var _jsxFileName = \"/Users/violetwang/iCloud Drive (Archive)/Documents/Workspace/React/wis/src/pages/LoginPage.js\";\nimport React, { Component } from 'react';\nimport { observer } from 'mobx-react';\nimport LoginForm from '../components/LoginForm';\nimport SignupForm from '../components/SignupForm';\nimport SubmitButton from '../components/SubmitButton';\nimport UserStore from '../stores/UserStore';\nimport './LoginPage.css';\nimport { AppContext } from '../context/AppContext';\n\nclass LoginPage extends Component {\n  async componentDidMount() {\n    try {\n      let res = await fetch('/isLoggedIn', {\n        method: 'post',\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        }\n      });\n      let result = await res.json();\n\n      if (result && result.success) {\n        UserStore.loading = false;\n        UserStore.isLoggedIn = true;\n        UserStore.username = result.username;\n      } else {\n        UserStore.loading = false;\n        UserStore.isLoggedIn = false;\n      }\n    } catch (e) {\n      UserStore.loading = false;\n      UserStore.isLoggedIn = false;\n    }\n  }\n\n  async doLogout() {\n    try {\n      let res = await fetch('/logout', {\n        method: 'post',\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        }\n      });\n      let result = await res.json();\n\n      if (result && result.success) {\n        UserStore.isLoggedIn = false;\n        UserStore.username = '';\n      }\n    } catch (e) {\n      console.log(e);\n    }\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      signup: false\n    };\n    this.showSignup = this.showSignup.bind(this);\n    this.hideSignup = this.hideSignup.bind(this);\n  }\n\n  showSignup() {\n    this.setState({\n      signup: true\n    });\n  }\n\n  hideSignup() {\n    this.setState({\n      signup: false\n    });\n  }\n\n  render() {\n    if (UserStore.loading) {\n      return React.createElement(\"div\", {\n        className: \"loginPage\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }, \"please wait...\"));\n    } else {\n      if (UserStore.isLoggedIn) {\n        return React.createElement(\"div\", {\n          className: \"loginPage\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 96\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 97\n          },\n          __self: this\n        }, \"Welcome \", UserStore.username, React.createElement(SubmitButton, {\n          text: 'Log out',\n          disabled: false,\n          onClick: this.doLogout,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 99\n          },\n          __self: this\n        })));\n      }\n\n      return React.createElement(AppContext.Consumer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, ({\n        auth,\n        setAuth\n      }) => {\n        return React.createElement(\"div\", {\n          className: \"loginPage\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 113\n          },\n          __self: this\n        }, this.state.signup ? React.createElement(SignupForm, {\n          hideSignup: this.hideSignup,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114\n          },\n          __self: this\n        }) : React.createElement(LoginForm, {\n          showSignup: this.showSignup,\n          auth: setAuth,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114\n          },\n          __self: this\n        })));\n      });\n    }\n  }\n\n}\n\nexport default observer(LoginPage);","map":{"version":3,"sources":["/Users/violetwang/iCloud Drive (Archive)/Documents/Workspace/React/wis/src/pages/LoginPage.js"],"names":["React","Component","observer","LoginForm","SignupForm","SubmitButton","UserStore","AppContext","LoginPage","componentDidMount","res","fetch","method","headers","result","json","success","loading","isLoggedIn","username","e","doLogout","console","log","constructor","props","state","signup","showSignup","bind","hideSignup","setState","render","auth","setAuth"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {observer} from 'mobx-react';\nimport LoginForm from '../components/LoginForm';\nimport SignupForm from '../components/SignupForm';\nimport SubmitButton from '../components/SubmitButton';\nimport UserStore from '../stores/UserStore';\nimport './LoginPage.css'\nimport { AppContext } from '../context/AppContext';\n\n\nclass LoginPage extends Component {\n\n    async componentDidMount() {\n\n        try {\n            let res = await fetch('/isLoggedIn', {\n                method: 'post',\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json'\n                }\n            });\n\n            let result = await res.json();\n\n            if (result && result.success) {\n                UserStore.loading = false;\n                UserStore.isLoggedIn = true;\n                UserStore.username = result.username;\n            }\n            else {\n                UserStore.loading = false;\n                UserStore.isLoggedIn = false;\n            }\n        }\n\n        catch(e) {\n            UserStore.loading = false;\n            UserStore.isLoggedIn = false;\n        }\n    }\n\n    async doLogout() {\n\n        try {\n            let res = await fetch('/logout', {\n                method: 'post',\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json'\n                }\n            });\n\n            let result = await res.json();\n\n            if (result && result.success) {\n                UserStore.isLoggedIn = false;\n                UserStore.username = '';\n            }\n        }\n\n        catch(e) {\n            console.log(e)\n        }\n    }\n\n\n    constructor(props){\n        super(props);\n        this.state = {\n            signup: false\n        };\n        this.showSignup = this.showSignup.bind(this);\n        this.hideSignup = this.hideSignup.bind(this);\n    };\n\n    showSignup() {\n        this.setState({signup:true})\n    };\n    hideSignup() {\n        this.setState({signup:false})\n    };\n\n    render() {\n        if (UserStore.loading) {\n            return (\n                <div className = \"loginPage\">\n                    <div className = \"container\">please wait...</div>\n                </div>\n            );\n            \n        }\n        else {\n            if (UserStore.isLoggedIn) {\n                return (\n                    <div className = \"loginPage\">\n                        <div className = \"container\">\n                            Welcome {UserStore.username}\n                            <SubmitButton \n                                text = {'Log out'}\n                                disabled = {false}\n                                onClick = {this.doLogout}\n                            />\n                        </div>\n                    </div>\n                );\n            }\n            return (\n                <AppContext.Consumer>\n                    {({auth,setAuth})=>{\n                        return(\n                            <div className = \"loginPage\">\n                                <div className = \"container\">\n                                    {this.state.signup?<SignupForm hideSignup={this.hideSignup}/>:<LoginForm showSignup={this.showSignup} auth={setAuth}/>}\n                                </div>\n                            </div>\n                        )\n                    }}\n                </AppContext.Consumer>\n            );\n        }    \n    }\n}\n\nexport default observer(LoginPage);"]},"metadata":{},"sourceType":"module"}