{"ast":null,"code":"import _regeneratorRuntime from\"/Users/violetwang/iCloud Drive (Archive)/Documents/Workspace/React/wis/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/violetwang/iCloud Drive (Archive)/Documents/Workspace/React/wis/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/violetwang/iCloud Drive (Archive)/Documents/Workspace/React/wis/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/violetwang/iCloud Drive (Archive)/Documents/Workspace/React/wis/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/violetwang/iCloud Drive (Archive)/Documents/Workspace/React/wis/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/violetwang/iCloud Drive (Archive)/Documents/Workspace/React/wis/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/violetwang/iCloud Drive (Archive)/Documents/Workspace/React/wis/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{observer}from'mobx-react';import LoginForm from'../components/LoginForm';import SubmitButton from'../components/SubmitButton';import UserStore from'../stores/UserStore';import'./LoginPage.css';var LoginPage=/*#__PURE__*/function(_Component){_inherits(LoginPage,_Component);function LoginPage(){_classCallCheck(this,LoginPage);return _possibleConstructorReturn(this,_getPrototypeOf(LoginPage).apply(this,arguments));}_createClass(LoginPage,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch('/isLoggedIn',{method:'post',headers:{'Accept':'application/json','Content-Type':'application/json'}});case 3:res=_context.sent;_context.next=6;return res.json();case 6:result=_context.sent;if(result&&result.success){UserStore.loading=false;UserStore.isLoggedIn=true;UserStore.username=result.username;}else{UserStore.loading=false;UserStore.isLoggedIn=false;}_context.next=14;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);UserStore.loading=false;UserStore.isLoggedIn=false;case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"doLogout\",value:function(){var _doLogout=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res,result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch('/logout',{method:'post',headers:{'Accept':'application/json','Content-Type':'application/json'}});case 3:res=_context2.sent;_context2.next=6;return res.json();case 6:result=_context2.sent;if(result&&result.success){UserStore.isLoggedIn=false;UserStore.username='';}_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[0,10]]);}));function doLogout(){return _doLogout.apply(this,arguments);}return doLogout;}()},{key:\"render\",value:function render(){var _this=this;if(UserStore.loading){return React.createElement(\"div\",{className:\"loginPage\"},React.createElement(\"div\",{className:\"container\"},\"please wait...\"));}else{if(UserStore.isLoggedIn){return React.createElement(\"div\",{className:\"loginPage\"},React.createElement(\"div\",{className:\"container\"},\"Welcome \",UserStore.username,React.createElement(SubmitButton,{text:'Log out',disabled:false,onClick:function onClick(){return _this.doLogout();}})));}return React.createElement(\"div\",{className:\"loginPage\"},React.createElement(\"div\",{className:\"container\"},React.createElement(LoginForm,null)));}}}]);return LoginPage;}(Component);export default observer(LoginPage);","map":{"version":3,"sources":["/Users/violetwang/iCloud Drive (Archive)/Documents/Workspace/React/wis/src/pages/LoginPage.js"],"names":["React","Component","observer","LoginForm","SubmitButton","UserStore","LoginPage","fetch","method","headers","res","json","result","success","loading","isLoggedIn","username","console","log","doLogout"],"mappings":"szCAAA,MAAOA,CAAAA,KAAP,EAAeC,SAAf,KAA+B,OAA/B,CACA,OAAQC,QAAR,KAAuB,YAAvB,CACA,MAAOC,CAAAA,SAAP,KAAsB,yBAAtB,CACA,MAAOC,CAAAA,YAAP,KAAyB,4BAAzB,CACA,MAAOC,CAAAA,SAAP,KAAsB,qBAAtB,CACA,MAAO,iBAAP,C,GAGMC,CAAAA,S,2hBAKsBC,CAAAA,KAAK,CAAC,aAAD,CAAgB,CACjCC,MAAM,CAAE,MADyB,CAEjCC,OAAO,CAAE,CACL,SAAU,kBADL,CAEL,eAAgB,kBAFX,CAFwB,CAAhB,C,QAAjBC,G,qCAQeA,CAAAA,GAAG,CAACC,IAAJ,E,QAAfC,M,eAEJ,GAAIA,MAAM,EAAIA,MAAM,CAACC,OAArB,CAA8B,CAC1BR,SAAS,CAACS,OAAV,CAAoB,KAApB,CACAT,SAAS,CAACU,UAAV,CAAuB,IAAvB,CACAV,SAAS,CAACW,QAAV,CAAqBJ,MAAM,CAACI,QAA5B,CACH,CAJD,IAKK,CACDX,SAAS,CAACS,OAAV,CAAoB,KAApB,CACAT,SAAS,CAACU,UAAV,CAAuB,KAAvB,CACH,C,iFAIDV,SAAS,CAACS,OAAV,CAAoB,KAApB,CACAT,SAAS,CAACU,UAAV,CAAuB,KAAvB,C,0dAOgBR,CAAAA,KAAK,CAAC,SAAD,CAAY,CAC7BC,MAAM,CAAE,MADqB,CAE7BC,OAAO,CAAE,CACL,SAAU,kBADL,CAEL,eAAgB,kBAFX,CAFoB,CAAZ,C,QAAjBC,G,uCAQeA,CAAAA,GAAG,CAACC,IAAJ,E,QAAfC,M,gBAEJ,GAAIA,MAAM,EAAIA,MAAM,CAACC,OAArB,CAA8B,CAC1BR,SAAS,CAACU,UAAV,CAAuB,KAAvB,CACAV,SAAS,CAACW,QAAV,CAAqB,EAArB,CACH,C,qFAIDC,OAAO,CAACC,GAAR,e,gMAIC,gBACL,GAAIb,SAAS,CAACS,OAAd,CAAuB,CACnB,MACI,4BAAK,SAAS,CAAG,WAAjB,EACI,2BAAK,SAAS,CAAG,WAAjB,mBADJ,CADJ,CAMH,CAPD,IAQK,CACD,GAAIT,SAAS,CAACU,UAAd,CAA0B,CACtB,MACI,4BAAK,SAAS,CAAG,WAAjB,EACI,2BAAK,SAAS,CAAG,WAAjB,aACaV,SAAS,CAACW,QADvB,CAEI,oBAAC,YAAD,EACI,IAAI,CAAI,SADZ,CAEI,QAAQ,CAAI,KAFhB,CAGI,OAAO,CAAK,yBAAM,CAAA,KAAI,CAACG,QAAL,EAAN,EAHhB,EAFJ,CADJ,CADJ,CAYH,CACD,MACI,4BAAK,SAAS,CAAG,WAAjB,EACI,2BAAK,SAAS,CAAG,WAAjB,EACI,oBAAC,SAAD,MADJ,CADJ,CADJ,CAOH,CACJ,C,uBAxFmBlB,S,EA2FxB,cAAeC,CAAAA,QAAQ,CAACI,SAAD,CAAvB","sourcesContent":["import React, {Component} from 'react';\nimport {observer} from 'mobx-react';\nimport LoginForm from '../components/LoginForm';\nimport SubmitButton from '../components/SubmitButton';\nimport UserStore from '../stores/UserStore';\nimport './LoginPage.css'\n\n\nclass LoginPage extends Component {\n\n    async componentDidMount() {\n\n        try {\n            let res = await fetch('/isLoggedIn', {\n                method: 'post',\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json'\n                }\n            });\n\n            let result = await res.json();\n\n            if (result && result.success) {\n                UserStore.loading = false;\n                UserStore.isLoggedIn = true;\n                UserStore.username = result.username;\n            }\n            else {\n                UserStore.loading = false;\n                UserStore.isLoggedIn = false;\n            }\n        }\n\n        catch(e) {\n            UserStore.loading = false;\n            UserStore.isLoggedIn = false;\n        }\n    }\n\n    async doLogout() {\n\n        try {\n            let res = await fetch('/logout', {\n                method: 'post',\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json'\n                }\n            });\n\n            let result = await res.json();\n\n            if (result && result.success) {\n                UserStore.isLoggedIn = false;\n                UserStore.username = '';\n            }\n        }\n\n        catch(e) {\n            console.log(e)\n        }\n    }\n\n    render() {\n        if (UserStore.loading) {\n            return (\n                <div className = \"loginPage\">\n                    <div className = \"container\">please wait...</div>\n                </div>\n            );\n            \n        }\n        else {\n            if (UserStore.isLoggedIn) {\n                return (\n                    <div className = \"loginPage\">\n                        <div className = \"container\">\n                            Welcome {UserStore.username}\n                            <SubmitButton \n                                text = {'Log out'}\n                                disabled = {false}\n                                onClick = { () => this.doLogout()}\n                            />\n                        </div>\n                    </div>\n                );\n            }\n            return (\n                <div className = \"loginPage\">\n                    <div className = \"container\">\n                        <LoginForm />\n                    </div>\n                </div>\n            );\n        }    \n    }\n}\n\nexport default observer(LoginPage);"]},"metadata":{},"sourceType":"module"}